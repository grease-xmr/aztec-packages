node:
  env:
    OTEL_SERVICE_NAME: "node"
    SPONSORED_FPC: true

  preStartScript: |
    if [ -n "${BOOT_NODE_HOST:-}" ] && [ -z "${NETWORK:-}" ]; then
      until curl --silent --head --fail "${BOOT_NODE_HOST}/status" > /dev/null; do
        echo "Waiting for boot node..."
        sleep 1
      done
      echo "Boot node is ready!"

      export BOOTSTRAP_NODES=$(curl -X POST -H "content-type: application/json" --data '{"method": "bootstrap_getEncodedEnr"}' $BOOT_NODE_HOST | jq -r .result)
    fi

  startCmd:
    - --node
    - --archiver
