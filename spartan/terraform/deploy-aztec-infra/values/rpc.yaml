node:
  env:
    OTEL_SERVICE_NAME: "node"
    AWS_ACCESS_KEY_ID: ""
    AWS_SECRET_ACCESS_KEY: ""

  preStartScript: |
    if [ -n "${BOOT_NODE_HOST:-}" ]; then
      until curl --silent --head --fail "${BOOT_NODE_HOST}/status" > /dev/null; do
        echo "Waiting for boot node..."
        sleep 1
      done
      echo "Boot node is ready!"

      export BOOTSTRAP_NODES=$(curl -X POST -H "content-type: application/json" --data '{"method": "bootstrap_getEncodedEnr"}' $BOOT_NODE_HOST | jq -r .result)
    fi

  startCmd:
    - --node
    - --archiver
